#ifndef RAW_OS_INTERRUPT_H
#define RAW_OS_INTERRUPT_H
#include "common.h"

#define IDT_BASE 0x00000000
#define IDT_SIZE 256

#define ISR0 0
#define ISR1 1
#define ISR2 2
#define ISR3 3
#define ISR4 4
#define ISR5 5
#define ISR6 6
#define ISR7 7
#define ISR8 8
#define ISR9 9
#define ISR10 10
#define ISR11 11
#define ISR12 12
#define ISR13 13
#define ISR14 14
#define ISR15 15
#define ISR16 16
#define ISR17 17
#define ISR18 18
#define ISR19 19
#define ISR20 20
#define ISR21 21
#define ISR22 22
#define ISR23 23
#define ISR24 24
#define ISR25 25
#define ISR26 26
#define ISR27 27
#define ISR28 28
#define ISR29 29
#define ISR30 30
#define ISR31 31
#define IRQ0 32
#define IRQ1 33
#define IRQ2 34
#define IRQ3 35
#define IRQ4 36
#define IRQ5 37
#define IRQ6 38
#define IRQ7 39
#define IRQ8 40
#define IRQ9 41
#define IRQ10 42
#define IRQ11 43
#define IRQ12 44
#define IRQ13 45
#define IRQ14 46
#define IRQ15 47

// Used for syscalls
#define ISR47 47
#define ISR48 48
#define ISR49 49
#define ISR50 50
#define ISR51 51
#define ISR52 52
#define ISR53 53
#define ISR54 54
#define ISR55 55
#define ISR56 56
#define ISR57 57
#define ISR58 58
#define ISR59 59
#define ISR60 60
#define ISR61 61
#define ISR62 62
#define ISR63 63
#define ISR64 64
#define ISR65 65
#define ISR66 66
#define ISR67 67
#define ISR68 68
#define ISR69 69
#define ISR70 70
#define ISR71 71
#define ISR72 72
#define ISR73 73
#define ISR74 74
#define ISR75 75
#define ISR76 76
#define ISR77 77
#define ISR78 78
#define ISR79 79
#define ISR80 80
#define ISR81 81
#define ISR82 82
#define ISR83 83
#define ISR84 84
#define ISR85 85
#define ISR86 86
#define ISR87 87
#define ISR88 88
#define ISR89 89
#define ISR90 90
#define ISR91 91
#define ISR92 92
#define ISR93 93
#define ISR94 94
#define ISR95 95
#define ISR96 96
#define ISR97 97
#define ISR98 98
#define ISR99 99
#define ISR100 100
#define ISR101 101
#define ISR102 102
#define ISR103 103
#define ISR104 104
#define ISR105 105
#define ISR106 106
#define ISR107 107
#define ISR108 108
#define ISR109 109
#define ISR110 110
#define ISR111 111
#define ISR112 112
#define ISR113 113
#define ISR114 114
#define ISR115 115
#define ISR116 116
#define ISR117 117
#define ISR118 118
#define ISR119 119
#define ISR120 120
#define ISR121 121
#define ISR122 122
#define ISR123 123
#define ISR124 124
#define ISR125 125
#define ISR126 126
#define ISR127 127
#define ISR128 128
#define ISR129 129
#define ISR130 130
#define ISR131 131
#define ISR132 132
#define ISR133 133
#define ISR134 134
#define ISR135 135
#define ISR136 136
#define ISR137 137
#define ISR138 138
#define ISR139 139
#define ISR140 140
#define ISR141 141
#define ISR142 142
#define ISR143 143
#define ISR144 144
#define ISR145 145
#define ISR146 146
#define ISR147 147
#define ISR148 148
#define ISR149 149
#define ISR150 150
#define ISR151 151
#define ISR152 152
#define ISR153 153
#define ISR154 154
#define ISR155 155
#define ISR156 156
#define ISR157 157
#define ISR158 158
#define ISR159 159
#define ISR160 160
#define ISR161 161
#define ISR162 162
#define ISR163 163
#define ISR164 164
#define ISR165 165
#define ISR166 166
#define ISR167 167
#define ISR168 168
#define ISR169 169
#define ISR170 170
#define ISR171 171
#define ISR172 172
#define ISR173 173
#define ISR174 174
#define ISR175 175
#define ISR176 176
#define ISR177 177
#define ISR178 178
#define ISR179 179
#define ISR180 180
#define ISR181 181
#define ISR182 182
#define ISR183 183
#define ISR184 184
#define ISR185 185
#define ISR186 186
#define ISR187 187
#define ISR188 188
#define ISR189 189
#define ISR190 190
#define ISR191 191
#define ISR192 192
#define ISR193 193
#define ISR194 194
#define ISR195 195
#define ISR196 196
#define ISR197 197
#define ISR198 198
#define ISR199 199
#define ISR200 200
#define ISR201 201
#define ISR202 202
#define ISR203 203
#define ISR204 204
#define ISR205 205
#define ISR206 206
#define ISR207 207
#define ISR208 208
#define ISR209 209
#define ISR210 210
#define ISR211 211
#define ISR212 212
#define ISR213 213
#define ISR214 214
#define ISR215 215
#define ISR216 216
#define ISR217 217
#define ISR218 218
#define ISR219 219
#define ISR220 220
#define ISR221 221
#define ISR222 222
#define ISR223 223
#define ISR224 224
#define ISR225 225
#define ISR226 226
#define ISR227 227
#define ISR228 228
#define ISR229 229
#define ISR230 230
#define ISR231 231
#define ISR232 232
#define ISR233 233
#define ISR234 234
#define ISR235 235
#define ISR236 236
#define ISR237 237
#define ISR238 238
#define ISR239 239
#define ISR240 240
#define ISR241 241
#define ISR242 242
#define ISR243 243
#define ISR244 244
#define ISR245 245
#define ISR246 246
#define ISR247 247
#define ISR248 248
#define ISR249 249
#define ISR250 250
#define ISR251 251
#define ISR252 252
#define ISR253 253
#define ISR254 254
#define ISR255 255

typedef struct {
	u32 edi, esi, ebp, esp, ebx, edx, ecx, eax;      // Pushed by pusha.
	u32 int_no, err_code;                            // Interrupt number and error code (if applicable)
	u32 eip, cs, eflags, useresp, ss;                // Pushed by the processor automatically.
} Interrupt_Handler_Args;

typedef void (*Interrupt_Handler)(const Interrupt_Handler_Args*);

void interrupt_init();
void interrupt_register_handler(Interrupt_Handler interrupt_handler, u32 interrupt_number);
#endif